<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Character Frequency Visualizer</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-primary: #0a0a0f;
    --bg-secondary: #12121a;
    --bg-tertiary: #1a1a26;
    --bg-card: #14141e;
    --text-primary: #e8e8f0;
    --text-secondary: #8888a0;
    --text-muted: #555570;
    --accent: #4a7cff;
    --border: #2a2a3a;
    --cold: #1a3a6a;
    --cold-mid: #2a5a9a;
    --warm: #cc4444;
    --hot: #ff3333;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg-primary);
    color: var(--text-primary);
    font-family: 'Outfit', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  .grain-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 999;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 40px 24px 60px;
  }

  header {
    text-align: center;
    margin-bottom: 40px;
  }

  header h1 {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.6rem;
    font-weight: 600;
    letter-spacing: -0.02em;
    color: var(--text-primary);
    margin-bottom: 6px;
  }

  header h1 span {
    color: var(--accent);
  }

  header p {
    font-size: 0.85rem;
    color: var(--text-muted);
    font-weight: 300;
  }

  .input-section {
    margin-bottom: 36px;
    position: relative;
  }

  textarea {
    width: 100%;
    height: 110px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text-primary);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9rem;
    padding: 16px 20px;
    resize: none;
    outline: none;
    transition: border-color 0.3s, box-shadow 0.3s;
    line-height: 1.6;
  }

  textarea:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(74, 124, 255, 0.12);
  }

  textarea::placeholder {
    color: var(--text-muted);
    font-family: 'Outfit', sans-serif;
    font-weight: 300;
  }

  .char-counter {
    position: absolute;
    bottom: 12px;
    right: 16px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.72rem;
    color: var(--text-muted);
    transition: color 0.3s;
  }

  .char-counter.warning { color: #cc8844; }
  .char-counter.danger { color: var(--warm); }

  .stats-row {
    display: flex;
    gap: 12px;
    margin-bottom: 36px;
    flex-wrap: wrap;
  }

  .stat-pill {
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 10px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.78rem;
  }

  .stat-pill .label {
    color: var(--text-muted);
    font-weight: 300;
  }

  .stat-pill .value {
    font-family: 'JetBrains Mono', monospace;
    font-weight: 600;
    color: var(--accent);
  }

  .section-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .section-title::before {
    content: '';
    width: 3px;
    height: 14px;
    background: var(--accent);
    border-radius: 2px;
  }

  /* ─── Bar Chart ─── */
  .chart-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 24px;
    margin-bottom: 36px;
  }

  .bar-chart {
    display: flex;
    align-items: flex-end;
    gap: 3px;
    height: 200px;
    padding-top: 10px;
    position: relative;
  }

  .bar-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 100%;
    justify-content: flex-end;
    position: relative;
  }

  .bar {
    width: 100%;
    min-height: 0;
    border-radius: 3px 3px 0 0;
    transition: height 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), background 0.3s;
    position: relative;
    cursor: pointer;
  }

  .bar:hover {
    filter: brightness(1.3);
  }

  .bar-tooltip {
    position: absolute;
    top: -28px;
    left: 50%;
    transform: translateX(-50%);
    background: #222;
    color: #fff;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    padding: 3px 7px;
    border-radius: 4px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
    white-space: nowrap;
    z-index: 10;
  }

  .bar:hover .bar-tooltip { opacity: 1; }

  .bar-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.6rem;
    color: var(--text-muted);
    margin-top: 6px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .y-axis-labels {
    position: absolute;
    left: -30px;
    top: 0;
    bottom: 20px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .y-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.55rem;
    color: var(--text-muted);
  }

  /* ─── Keyboard ─── */
  .keyboard-section {
    margin-bottom: 36px;
  }

  .keyboard {
    display: flex;
    flex-direction: column;
    gap: 6px;
    align-items: center;
  }

  .kb-row {
    display: flex;
    gap: 6px;
  }

  .key {
    position: relative;
    width: 56px;
    height: 56px;
    border-radius: 8px;
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'JetBrains Mono', monospace;
    transition: all 0.35s ease;
    cursor: default;
    overflow: hidden;
  }

  .key .letter {
    font-size: 0.95rem;
    font-weight: 600;
    color: var(--text-primary);
    z-index: 1;
    transition: color 0.3s;
    text-transform: uppercase;
  }

  .key .count {
    position: absolute;
    bottom: 4px;
    right: 5px;
    font-size: 0.55rem;
    font-weight: 500;
    color: rgba(255,255,255,0.5);
    z-index: 1;
    transition: color 0.3s;
  }

  .key.active .count {
    color: rgba(255,255,255,0.85);
  }

  .key-number {
    width: 50px;
    height: 46px;
  }

  .key-wide {
    width: 80px;
  }

  .key-space {
    width: 320px;
  }

  /* ─── Color Scale Legend ─── */
  .legend {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 20px;
    justify-content: center;
  }

  .legend-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    color: var(--text-muted);
    font-weight: 400;
  }

  .legend-bar {
    width: 200px;
    height: 10px;
    border-radius: 5px;
    background: linear-gradient(to right, #1a2a44, #1a3a6a, #2a5a9a, #6a8a44, #ccaa22, #cc6622, #cc3333, #ff2222);
  }

  /* ─── Empty State ─── */
  .empty-state {
    text-align: center;
    padding: 40px;
    color: var(--text-muted);
    font-size: 0.85rem;
    font-weight: 300;
  }

  .empty-state .icon {
    font-size: 2rem;
    margin-bottom: 10px;
    opacity: 0.4;
  }

  /* ─── Responsive ─── */
  @media (max-width: 768px) {
    .container { padding: 24px 14px; }
    .key { width: 34px; height: 40px; }
    .key .letter { font-size: 0.7rem; }
    .key .count { font-size: 0.45rem; }
    .key-number { width: 30px; height: 34px; }
    .key-wide { width: 50px; }
    .key-space { width: 180px; }
    .kb-row { gap: 3px; }
    .keyboard { gap: 3px; }
    .bar-chart { height: 150px; }
    .bar-label { font-size: 0.45rem; }
  }
</style>
</head>
<body>

<div class="grain-overlay"></div>

<div class="container">
  <header>
    <h1>char<span>freq</span></h1>
    <p>Real-time character frequency analysis & keyboard heatmap</p>
  </header>

  <div class="input-section">
    <textarea id="textInput" maxlength="500" placeholder="Start typing to see the frequency distribution and keyboard heatmap light up..."></textarea>
    <div class="char-counter" id="charCounter">0 / 500</div>
  </div>

  <div class="stats-row" id="statsRow">
    <div class="stat-pill"><span class="label">Total chars</span><span class="value" id="statTotal">0</span></div>
    <div class="stat-pill"><span class="label">Letters</span><span class="value" id="statLetters">0</span></div>
    <div class="stat-pill"><span class="label">Unique</span><span class="value" id="statUnique">0</span></div>
    <div class="stat-pill"><span class="label">Most used</span><span class="value" id="statTop">—</span></div>
  </div>

  <div class="section-title">Frequency Distribution</div>
  <div class="chart-card">
    <div class="bar-chart" id="barChart"></div>
  </div>

  <div class="section-title">Keyboard Heatmap</div>
  <div class="chart-card">
    <div class="keyboard" id="keyboard"></div>
    <div class="legend">
      <span class="legend-label">0</span>
      <div class="legend-bar"></div>
      <span class="legend-label">max</span>
    </div>
  </div>
</div>

<script>
  const LETTERS = 'abcdefghijklmnopqrstuvwxyz'.split('');
  const NUMBERS = '1234567890'.split('');

  const KB_ROWS = [
    { keys: NUMBERS, type: 'number' },
    { keys: 'qwertyuiop'.split(''), type: 'letter' },
    { keys: 'asdfghjkl'.split(''), type: 'letter' },
    { keys: 'zxcvbnm'.split(''), type: 'letter' },
  ];

  const textInput = document.getElementById('textInput');
  const charCounter = document.getElementById('charCounter');
  const barChart = document.getElementById('barChart');
  const keyboard = document.getElementById('keyboard');

  // Build bar chart
  function buildBarChart() {
    barChart.innerHTML = '';
    LETTERS.forEach(letter => {
      const wrapper = document.createElement('div');
      wrapper.className = 'bar-wrapper';

      const bar = document.createElement('div');
      bar.className = 'bar';
      bar.id = `bar-${letter}`;
      bar.style.height = '0px';
      bar.style.background = '#1a2a44';

      const tooltip = document.createElement('div');
      tooltip.className = 'bar-tooltip';
      tooltip.id = `tip-${letter}`;
      tooltip.textContent = `${letter.toUpperCase()}: 0`;
      bar.appendChild(tooltip);

      const label = document.createElement('div');
      label.className = 'bar-label';
      label.textContent = letter;

      wrapper.appendChild(bar);
      wrapper.appendChild(label);
      barChart.appendChild(wrapper);
    });
  }

  // Build keyboard
  function buildKeyboard() {
    keyboard.innerHTML = '';
    KB_ROWS.forEach(row => {
      const rowEl = document.createElement('div');
      rowEl.className = 'kb-row';

      row.keys.forEach(k => {
        const key = document.createElement('div');
        key.className = 'key' + (row.type === 'number' ? ' key-number' : '');
        key.id = `key-${k}`;
        key.style.background = 'var(--bg-tertiary)';

        const letter = document.createElement('span');
        letter.className = 'letter';
        letter.textContent = k.toUpperCase();

        const count = document.createElement('span');
        count.className = 'count';
        count.id = `kc-${k}`;
        count.textContent = '';

        key.appendChild(letter);
        key.appendChild(count);
        rowEl.appendChild(key);
      });

      keyboard.appendChild(rowEl);
    });
  }

  // Color interpolation
  function getHeatColor(ratio) {
    // Blue → Cyan → Green → Yellow → Orange → Red
    const stops = [
      { r: 26, g: 42, b: 68 },    // 0.0 - dark blue
      { r: 30, g: 70, b: 120 },    // 0.15
      { r: 40, g: 110, b: 160 },   // 0.3 - cyan-blue
      { r: 60, g: 140, b: 70 },    // 0.45 - green
      { r: 180, g: 170, b: 30 },   // 0.6 - yellow
      { r: 210, g: 110, b: 30 },   // 0.75 - orange
      { r: 210, g: 50, b: 40 },    // 0.9 - red
      { r: 255, g: 30, b: 30 },    // 1.0 - hot red
    ];

    const t = Math.max(0, Math.min(1, ratio));
    const segment = t * (stops.length - 1);
    const i = Math.floor(segment);
    const f = segment - i;

    if (i >= stops.length - 1) return stops[stops.length - 1];

    const a = stops[i], b = stops[i + 1];
    return {
      r: Math.round(a.r + (b.r - a.r) * f),
      g: Math.round(a.g + (b.g - a.g) * f),
      b: Math.round(a.b + (b.b - a.b) * f),
    };
  }

  function update() {
    const text = textInput.value.toLowerCase();
    const len = textInput.value.length;

    // Char counter
    charCounter.textContent = `${len} / 500`;
    charCounter.className = 'char-counter' + (len > 450 ? ' danger' : len > 380 ? ' warning' : '');

    // Count frequencies
    const freq = {};
    const allKeys = [...LETTERS, ...NUMBERS];
    allKeys.forEach(c => freq[c] = 0);

    for (const ch of text) {
      if (freq.hasOwnProperty(ch)) freq[ch]++;
    }

    const letterCounts = LETTERS.map(l => freq[l]);
    const maxCount = Math.max(...allKeys.map(k => freq[k]), 1);
    const maxLetterCount = Math.max(...letterCounts, 1);
    const totalLetters = letterCounts.reduce((a, b) => a + b, 0);
    const uniqueLetters = letterCounts.filter(c => c > 0).length;

    // Find top letter
    let topLetter = '—';
    let topCount = 0;
    LETTERS.forEach(l => {
      if (freq[l] > topCount) { topCount = freq[l]; topLetter = l.toUpperCase(); }
    });

    // Update stats
    document.getElementById('statTotal').textContent = len;
    document.getElementById('statLetters').textContent = totalLetters;
    document.getElementById('statUnique').textContent = uniqueLetters;
    document.getElementById('statTop').textContent = topCount > 0 ? `${topLetter} (${topCount})` : '—';

    // Update bars
    LETTERS.forEach(l => {
      const bar = document.getElementById(`bar-${l}`);
      const tip = document.getElementById(`tip-${l}`);
      const count = freq[l];
      const ratio = maxLetterCount > 0 ? count / maxLetterCount : 0;
      const heightPx = count > 0 ? Math.max(4, (ratio * 180)) : 0;

      bar.style.height = `${heightPx}px`;
      const color = getHeatColor(ratio);
      bar.style.background = count > 0
        ? `rgb(${color.r}, ${color.g}, ${color.b})`
        : '#1a2a44';
      tip.textContent = `${l.toUpperCase()}: ${count}`;
    });

    // Update keyboard
    allKeys.forEach(k => {
      const keyEl = document.getElementById(`key-${k}`);
      const countEl = document.getElementById(`kc-${k}`);
      const count = freq[k];
      const ratio = maxCount > 0 ? count / maxCount : 0;

      if (count > 0) {
        const color = getHeatColor(ratio);
        keyEl.style.background = `rgb(${color.r}, ${color.g}, ${color.b})`;
        keyEl.style.borderColor = `rgba(${Math.min(255, color.r + 40)}, ${Math.min(255, color.g + 20)}, ${Math.min(255, color.b + 20)}, 0.4)`;
        keyEl.classList.add('active');
        countEl.textContent = count;
      } else {
        keyEl.style.background = 'var(--bg-tertiary)';
        keyEl.style.borderColor = 'var(--border)';
        keyEl.classList.remove('active');
        countEl.textContent = '';
      }
    });
  }

  // Init
  buildBarChart();
  buildKeyboard();

  textInput.addEventListener('input', update);

  // Start with a demo sentence so it's not empty
  textInput.value = '';
  update();
</script>

</body>
</html>
